chrome.runtime.onInstalled.addListener(()=>{console.log("UX Refactor Assistant installed")});chrome.runtime.onMessage.addListener((t,e,r)=>{var o,a;switch(console.log("Background received message:",t),t.type){case"CAPTURE_TAB":return c((o=e.tab)==null?void 0:o.id,r),!0;case"ANALYZE_PAGE":return l((a=e.tab)==null?void 0:a.id,r),!0;default:r({error:"Unknown message type"})}});async function c(t,e){if(!t){e({error:"No tab ID provided"});return}try{const r=await chrome.tabs.captureVisibleTab(t,{format:"png",quality:100}),a=await(await fetch(r)).blob();e({success:!0,screenshot:a,timestamp:Date.now()})}catch(r){console.error("Capture failed:",r),e({error:"Failed to capture screenshot"})}}async function l(t,e){if(!t){e({error:"No tab ID provided"});return}try{const r=await chrome.scripting.executeScript({target:{tabId:t},func:()=>({url:window.location.href,title:document.title,elements:document.querySelectorAll("button, input, a, p, h1, h2, h3, h4, h5, h6").length})});r&&r[0]&&r[0].result?e({success:!0,data:r[0].result}):e({error:"No analysis results"})}catch(r){console.error("Analysis failed:",r),e({error:"Failed to analyze page"})}}
